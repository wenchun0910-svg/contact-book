<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºæ…§ç­ç´šæ‰“å¡ç³»çµ±</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- è¨­å®š Tailwind è‡ªå®šç¾©é…ç½® -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'fade-in-down': 'fadeInDown 0.5s ease-out',
                    },
                    keyframes: {
                        fadeInDown: {
                            '0%': { opacity: '0', transform: 'translateY(-20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* è£œå……èƒŒæ™¯ç¶²æ ¼æ¨£å¼ */
        .bg-grid-slate-50 {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(248 250 252)'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
        }
        /* è¨­å®šåŸºæœ¬å­—é«” */
        body {
            font-family: 'Comic Sans MS', 'Microsoft JhengHei', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- ä½¿ç”¨ ES Modules å¼•å…¥ React å’Œç›¸é—œå¥—ä»¶ -->
    <script type="module">
        import React, { useState, useEffect, useMemo, useRef } from 'https://esm.sh/react@18.2.0';
        import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';
        // å¼•å…¥ Lucide åœ–ç¤º
        import { Users, UserCheck, AlertCircle, Settings, RotateCcw, Download, Edit3, Save, Check, AlignVerticalJustifyStart, AlignHorizontalJustifyStart, ChevronLeft, ChevronRight, Upload, FileJson, FileSpreadsheet, Star, Heart, Cloud, Layout, Monitor, BookOpen, Clock, Palette, GripVertical, Minus, Plus, Type } from 'https://esm.sh/lucide-react@0.300.0';

        const App = () => {
          // ---------------------------------------------------------------------------
          // ç‹€æ…‹è¨­å®š
          // ---------------------------------------------------------------------------
          const DEFAULT_STUDENT_COUNT = 30;
          const DEFAULT_LATE_TIME = "07:50";

          const [currentTime, setCurrentTime] = useState(new Date());
          const [lateThreshold, setLateThreshold] = useState(DEFAULT_LATE_TIME);
          const [studentCount, setStudentCount] = useState(DEFAULT_STUDENT_COUNT);
          const [emptyNumbersInput, setEmptyNumbersInput] = useState(""); 
          const [customNamesInput, setCustomNamesInput] = useState(""); 
          const [showSettings, setShowSettings] = useState(false);
          const [isEditingNote, setIsEditingNote] = useState(false);
          
          // æª¢è¦–æ¨¡å¼ ('split' | 'checkin' | 'notebook')
          const [viewMode, setViewMode] = useState('split');

          // æ›¸å¯«æ–¹å‘ç‹€æ…‹ ('horizontal' | 'vertical')
          const [writingMode, setWritingMode] = useState(() => {
            return localStorage.getItem('class_note_writing_mode') || 'horizontal';
          });

          // æ™‚é˜æ¨£å¼è¨­å®š (0~4)
          const [clockStyleIndex, setClockStyleIndex] = useState(() => {
            const saved = localStorage.getItem('class_clock_style');
            return saved ? parseInt(saved, 10) : 0;
          });

          // åˆ†å±æ¯”ä¾‹è¨­å®š (å·¦å´ä½”æ¯” %)
          const [splitRatio, setSplitRatio] = useState(() => {
            const saved = localStorage.getItem('class_split_ratio');
            return saved ? parseFloat(saved) : 50;
          });

          // è¯çµ¡ç°¿å­—é«”å¤§å°è¨­å®š (px)
          const [notebookFontSize, setNotebookFontSize] = useState(() => {
            const saved = localStorage.getItem('class_notebook_font_size');
            return saved ? parseInt(saved, 10) : 32;
          });

          // å­—é«”é¡å‹è¨­å®š ('sans' | 'kai' | 'zhuyin')
          const [fontType, setFontType] = useState(() => {
            return localStorage.getItem('class_font_type') || 'sans';
          });
          
          // è¯çµ¡ç°¿å…§å®¹
          const [notesData, setNotesData] = useState(() => {
            const saved = localStorage.getItem('class_notes_data');
            if (saved) {
              try {
                return JSON.parse(saved);
              } catch (e) {
                console.error("Failed to parse notes data", e);
              }
            }
            const oldContent = localStorage.getItem('class_note_content');
            const todayKey = new Date().toISOString().split('T')[0];
            const defaultText = "åœ‹ç¿’ P.30-32\næ•¸ä½œ Ch.3\næ˜å¸¶æ°´å½©ç”¨å…·\näº¤åˆé¤å›æ¢\né€±äº”æˆ¶å¤–æ•™å­¸\nåšå®¶äº‹";
            
            return oldContent ? { [todayKey]: oldContent } : {
              [todayKey]: defaultText
            };
          });

          const [notebookDate, setNotebookDate] = useState(new Date());
          const [students, setStudents] = useState([]);
          const fileInputRef = useRef(null);
          const splitContainerRef = useRef(null);

          // å­—é«”è¨­å®šå°æ‡‰çš„ CSS font-family
          const getFontFamily = (type) => {
            switch (type) {
              case 'kai': // æ¨™æ¥·é«”
                return "'æ¨™æ¥·é«”', 'DFKai-SB', 'KaiTi', 'BiauKai', serif";
              case 'zhuyin': // å˜—è©¦å‘¼å«å¸¸è¦‹æ³¨éŸ³å­—å‹ (éœ€é›»è…¦æœ‰å®‰è£)
                return "'ç‹æ¼¢å®—ä¸­æ¥·é«”æ³¨éŸ³', 'HanWangKaiMediumChuIn', 'æ–‡é¼ä¸­æ¥·æ³¨éŸ³', 'AR PL KaiTiM Big5', 'å…¨å­—åº«æ³¨éŸ³', 'DFKai-SB', 'KaiTi', serif";
              case 'sans': // é»‘é«”/å¯æ„›é«” (é è¨­)
              default:
                return "'Comic Sans MS', 'Chalkboard SE', 'Marker Felt', ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif";
            }
          };

          const currentFontFamily = getFontFamily(fontType);

          // æ™‚é˜æ¨£å¼å®šç¾©
          const CLOCK_STYLES = [
            {
              id: 'simple',
              name: 'ç°¡ç´„ç™½',
              container: 'bg-white border-slate-200 shadow-[inset_0_2px_6px_rgba(0,0,0,0.05)]',
              text: 'text-slate-800',
              icon: 'text-slate-400',
              labelColor: 'text-slate-400 bg-slate-100'
            },
            {
              id: 'orange',
              name: 'æ´»åŠ›æ©˜',
              container: 'bg-orange-50 border-orange-200 shadow-sm',
              text: 'text-orange-600',
              icon: 'text-orange-300',
              labelColor: 'text-orange-500 bg-orange-100'
            },
            {
              id: 'blue',
              name: 'å¤©ç©ºè—',
              container: 'bg-sky-50 border-sky-200 shadow-sm',
              text: 'text-sky-600',
              icon: 'text-sky-300',
              labelColor: 'text-sky-500 bg-sky-100'
            },
            {
              id: 'purple',
              name: 'å„ªé›…ç´«',
              container: 'bg-purple-50 border-purple-200 shadow-sm',
              text: 'text-purple-600',
              icon: 'text-purple-300',
              labelColor: 'text-purple-500 bg-purple-100'
            },
            {
              id: 'dark',
              name: 'ç§‘æŠ€é»‘',
              container: 'bg-slate-900 border-slate-700 shadow-inner',
              text: 'text-emerald-400 drop-shadow-[0_0_5px_rgba(52,211,153,0.8)]',
              icon: 'text-emerald-700',
              labelColor: 'text-slate-300 bg-slate-800'
            }
          ];

          const currentClockStyle = CLOCK_STYLES[clockStyleIndex % CLOCK_STYLES.length];

          const toggleClockStyle = () => {
            const nextIndex = (clockStyleIndex + 1) % CLOCK_STYLES.length;
            setClockStyleIndex(nextIndex);
            localStorage.setItem('class_clock_style', nextIndex);
          };

          // åˆå§‹åŒ–
          useEffect(() => {
            const savedCustomNames = localStorage.getItem('class_custom_names');
            if (savedCustomNames) {
              setCustomNamesInput(savedCustomNames);
              recalculateStudents(studentCount, emptyNumbersInput, savedCustomNames);
            } else {
              if (students.length === 0) {
                 resetSystem();
              }
            }
          }, []); 

          // ç•¶è¨­å®šæ”¹è®Šæ™‚
          const handleSettingChange = (newCount, newEmpty, newNames) => {
            setStudentCount(newCount);
            setEmptyNumbersInput(newEmpty);
            setCustomNamesInput(newNames);
            localStorage.setItem('class_custom_names', newNames);
            recalculateStudents(newCount, newEmpty, newNames);
          };

          const recalculateStudents = (count, emptyStr, namesStr) => {
            const newStudents = [];
            const names = namesStr ? namesStr.split(/[,ï¼Œ\n]+/).map(n => n.trim()).filter(n => n !== "") : [];

            if (names.length > 0) {
              names.forEach((name, index) => {
                newStudents.push({
                  id: index + 1, 
                  name: name,    
                  status: 'idle',
                  arrivalTime: null,
                });
              });
            } else {
              const emptySet = new Set(
                emptyStr
                  .split(/[,ï¼Œ\s]+/)
                  .map(n => parseInt(n.trim()))
                  .filter(n => !isNaN(n) && n > 0)
              );

              let activeCount = 0; 
              let currentSeatId = 1; 

              while (activeCount < count) {
                if (emptySet.has(currentSeatId)) {
                  newStudents.push({ id: currentSeatId, name: `${currentSeatId}`, status: 'empty', arrivalTime: null });
                } else {
                  newStudents.push({ id: currentSeatId, name: `${currentSeatId}`, status: 'idle', arrivalTime: null });
                  activeCount++; 
                }
                currentSeatId++; 
              }
            }
            setStudents(newStudents);
          };

          // å„²å­˜è³‡æ–™
          useEffect(() => {
            localStorage.setItem('class_notes_data', JSON.stringify(notesData));
          }, [notesData]);

          useEffect(() => {
            localStorage.setItem('class_note_writing_mode', writingMode);
          }, [writingMode]);

          // å„²å­˜åˆ†å±è¨­å®š
          useEffect(() => {
            localStorage.setItem('class_split_ratio', splitRatio);
          }, [splitRatio]);

          // å„²å­˜å­—é«”å¤§å°è¨­å®š
          useEffect(() => {
            localStorage.setItem('class_notebook_font_size', notebookFontSize);
          }, [notebookFontSize]);

          // å„²å­˜å­—é«”é¡å‹è¨­å®š
          useEffect(() => {
            localStorage.setItem('class_font_type', fontType);
          }, [fontType]);

          useEffect(() => {
            const timer = setInterval(() => {
              const now = new Date();
              setCurrentTime(now);
              checkLateStatus(now);
            }, 1000);
            return () => clearInterval(timer);
          }, [lateThreshold]);

          const checkLateStatus = (now) => {
            const [thresholdHour, thresholdMinute] = lateThreshold.split(':').map(Number);
            const thresholdDate = new Date(now);
            thresholdDate.setHours(thresholdHour, thresholdMinute, 0, 0);
            const resetDate = new Date(now);
            resetDate.setHours(17, 0, 0, 0);

            const isLateAlertPeriod = now >= thresholdDate && now < resetDate;

            if (isLateAlertPeriod) {
              setStudents(prevStudents => 
                prevStudents.map(student => {
                  if (student.status === 'idle') {
                    return { ...student, status: 'late_absent' };
                  }
                  return student;
                })
              );
            } else {
              setStudents(prevStudents => 
                prevStudents.map(student => {
                  if (student.status === 'late_absent') {
                    return { ...student, status: 'idle' };
                  }
                  return student;
                })
              );
            }
          };

          const handleCheckIn = (id) => {
            const student = students.find(s => s.id === id);
            if (!student || student.status === 'empty') return;

            const now = new Date();
            const timeString = now.toTimeString().slice(0, 5);
            const [thresholdHour, thresholdMinute] = lateThreshold.split(':').map(Number);
            const thresholdDate = new Date(now);
            thresholdDate.setHours(thresholdHour, thresholdMinute, 0, 0);
            
            const isLate = now >= thresholdDate;
            const resetDate = new Date(now);
            resetDate.setHours(17, 0, 0, 0);
            const isLateAlertPeriod = now >= thresholdDate && now < resetDate;

            setStudents(prevStudents => 
              prevStudents.map(student => {
                if (student.id !== id) return student;

                if (student.status === 'present' || student.status === 'late_arrived') {
                   return { 
                     ...student, 
                     status: isLateAlertPeriod ? 'late_absent' : 'idle', 
                     arrivalTime: null 
                   };
                }

                if (student.status === 'idle' || student.status === 'late_absent') {
                  return { 
                    ...student, 
                    status: isLate ? 'late_arrived' : 'present', 
                    arrivalTime: timeString 
                  };
                }
                
                return student;
              })
            );
          };

          const getNoteDateKey = (date) => {
            const y = date.getFullYear();
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const d = String(date.getDate()).padStart(2, '0');
            return `${y}-${m}-${d}`;
          };

          const currentNoteKey = getNoteDateKey(notebookDate);
          const currentNoteContent = notesData[currentNoteKey] || "";

          const updateCurrentNote = (content) => {
            setNotesData(prev => ({
              ...prev,
              [currentNoteKey]: content
            }));
          };

          const handleExportCSV = () => {
            const statusMap = {
              'idle': 'æœªåˆ°æ ¡',
              'present': 'æº–æ™‚åˆ°æ ¡',
              'late_absent': 'é²åˆ°æœªåˆ°',
              'late_arrived': 'é²åˆ°å·²åˆ°',
              'empty': 'ç©ºè™Ÿ'
            };
            const dateStr = currentTime.toLocaleDateString('zh-TW');
            
            let csvContent = "æ—¥æœŸ,åº§è™Ÿ,å§“å,ç‹€æ…‹,åˆ°æ ¡æ™‚é–“,é²åˆ°é–€æª»\n";
            students.forEach(student => {
              const statusText = statusMap[student.status];
              const timeText = student.arrivalTime || '--';
              const nameText = student.name || student.id;
              
              const row = `${dateStr},${student.id},${nameText},${statusText},${timeText},${lateThreshold}`;
              csvContent += row + "\n";
            });

            csvContent += "\n\n=== è¯çµ¡ç°¿ç´€éŒ„ (æ‰€æœ‰æ—¥æœŸ) ===\n";
            
            const sortedDates = Object.keys(notesData).sort();
            sortedDates.forEach(dateKey => {
                const content = notesData[dateKey];
                if (!content.trim()) return;

                csvContent += `\n[${dateKey}]\n`;
                const lines = content.split('\n').filter(line => line.trim() !== '');
                lines.forEach((line, index) => {
                    csvContent += `${index + 1}.${line.replace(/,/g, 'ï¼Œ')}\n`;
                });
            });

            const blob = new Blob(["\ufeff" + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", `ç­ç´šæ‰“å¡èˆ‡è¯çµ¡ç°¿_${dateStr.replace(/\//g, '-')}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
          };

          const handleBackupJSON = () => {
            const backupData = {
              timestamp: new Date().toISOString(),
              settings: {
                studentCount,
                lateThreshold,
                emptyNumbersInput,
                writingMode,
                customNamesInput,
                splitRatio,
                notebookFontSize,
                fontType
              },
              students,
              notesData
            };
            
            const jsonStr = JSON.stringify(backupData, null, 2);
            const blob = new Blob([jsonStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", `ç³»çµ±å‚™ä»½_${getNoteDateKey(new Date())}.json`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
          };

          const handleImportJSON = (e) => {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (event) => {
              try {
                const data = JSON.parse(event.target.result);
                if (data.settings && data.students && data.notesData) {
                  setStudentCount(data.settings.studentCount);
                  setLateThreshold(data.settings.lateThreshold);
                  setEmptyNumbersInput(data.settings.emptyNumbersInput);
                  setCustomNamesInput(data.settings.customNamesInput || "");
                  setWritingMode(data.settings.writingMode || 'horizontal');
                  if (data.settings.splitRatio) setSplitRatio(data.settings.splitRatio);
                  if (data.settings.notebookFontSize) setNotebookFontSize(data.settings.notebookFontSize);
                  if (data.settings.fontType) setFontType(data.settings.fontType);
                  setStudents(data.students);
                  setNotesData(data.notesData);
                  
                  localStorage.setItem('class_custom_names', data.settings.customNamesInput || "");

                  alert("ç³»çµ±è³‡æ–™å·²æˆåŠŸé‚„åŸï¼");
                } else {
                  alert("ç„¡æ•ˆçš„å‚™ä»½æª”æ¡ˆæ ¼å¼ã€‚");
                }
              } catch (err) {
                console.error(err);
                alert("è®€å–æª”æ¡ˆå¤±æ•—ï¼Œè«‹ç¢ºèªæª”æ¡ˆæ˜¯å¦æ­£ç¢ºã€‚");
              }
            };
            reader.readAsText(file);
            e.target.value = null;
          };

          const triggerImport = () => {
            fileInputRef.current.click();
          };

          const resetSystem = () => {
            recalculateStudents(studentCount, emptyNumbersInput, customNamesInput);
          };

          const stats = useMemo(() => {
            const activeStudents = students.filter(s => s.status !== 'empty');
            const present = activeStudents.filter(s => s.status === 'present').length;
            const lateArrived = activeStudents.filter(s => s.status === 'late_arrived').length;
            const lateAbsent = activeStudents.filter(s => s.status === 'late_absent').length;
            const idle = activeStudents.filter(s => s.status === 'idle').length;
            return { present, lateArrived, lateAbsent, idle, total: activeStudents.length };
          }, [students]);

          const formatTime = (date) => {
            return date.toLocaleTimeString('zh-TW', { hour12: false });
          };

          const formatNotebookDate = (date) => {
            return date.toLocaleDateString('zh-TW', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });
          };

          const validNoteLines = useMemo(() => {
            return currentNoteContent.split('\n').filter(line => line.trim() !== '');
          }, [currentNoteContent]);

          const getGridColsClass = () => {
            const totalGrids = students.length;
            if (totalGrids <= 30) return "grid-cols-5";
            if (totalGrids <= 42) return "grid-cols-6";
            if (totalGrids <= 56) return "grid-cols-8";
            return "grid-cols-10";
          };

          const changeDate = (days) => {
            const newDate = new Date(notebookDate);
            newDate.setDate(newDate.getDate() + days);
            setNotebookDate(newDate);
          };

          const isToday = (date) => {
            const today = new Date();
            return date.getDate() === today.getDate() &&
                   date.getMonth() === today.getMonth() &&
                   date.getFullYear() === today.getFullYear();
          };

          // èª¿æ•´å­—é«”å¤§å°åŠŸèƒ½
          const adjustFontSize = (delta) => {
            setNotebookFontSize(prev => {
              const newSize = prev + delta;
              return Math.max(16, Math.min(newSize, 72)); // é™åˆ¶åœ¨ 16px - 72px
            });
          };

          // è™•ç†æ‹–æ›³èª¿æ•´å¯¬åº¦
          const handleDragStart = (e) => {
            e.preventDefault();
            document.addEventListener('mousemove', handleDragMove);
            document.addEventListener('mouseup', handleDragEnd);
          };

          const handleDragMove = (e) => {
            if (splitContainerRef.current) {
              const containerRect = splitContainerRef.current.getBoundingClientRect();
              let newRatio = ((e.clientX - containerRect.left) / containerRect.width) * 100;
              newRatio = Math.max(20, Math.min(newRatio, 80));
              setSplitRatio(newRatio);
            }
          };

          const handleDragEnd = () => {
            document.removeEventListener('mousemove', handleDragMove);
            document.removeEventListener('mouseup', handleDragEnd);
          };

          // å®šç¾© notebook æ¨£å¼è®Šæ•¸
          const notebookFontClasses = viewMode === 'notebook' 
            ? 'text-4xl 2xl:text-6xl leading-relaxed tracking-wider' 
            : 'text-3xl 2xl:text-4xl leading-relaxed tracking-wide'; 

          const notebookNumberSize = viewMode === 'notebook'
            ? 'w-12 h-12 text-2xl' 
            : 'w-8 h-8 text-xl';

          return (
            <div className="h-screen bg-slate-100 font-sans text-slate-800 flex flex-col overflow-hidden relative selection:bg-pink-200">
              
              {/* èƒŒæ™¯è£é£¾ */}
              <div className="absolute top-10 left-10 text-pink-200 opacity-30 pointer-events-none">
                <Heart className="w-12 h-12" fill="currentColor" />
              </div>
              <div className="absolute bottom-20 right-20 text-yellow-200 opacity-30 pointer-events-none">
                <Star className="w-16 h-16" fill="currentColor" />
              </div>

              <input 
                type="file" 
                accept=".json"
                ref={fileInputRef}
                onChange={handleImportJSON}
                className="hidden"
              />

              {/* é ‚éƒ¨å·¥å…·åˆ— */}
              <div className="bg-white/80 backdrop-blur-md px-6 py-2 flex justify-between items-center z-20 shrink-0 border-b-4 border-orange-100 h-16 shadow-sm rounded-b-3xl mx-2">
                 <h1 className="text-xl 2xl:text-2xl font-black text-orange-600 flex items-center gap-3 tracking-wider transform hover:scale-105 transition-transform cursor-default">
                    <div className="bg-orange-100 p-2 rounded-full">
                      <Users className="w-6 h-6 2xl:w-7 2xl:h-7 text-orange-500" />
                    </div>
                    <span className="drop-shadow-sm">â­ä¸Šå­¸æ‰“å¡ç‹â­</span>
                 </h1>
                 <div className="flex items-center gap-3">
                    <div className="text-xs 2xl:text-sm font-bold text-slate-400 mr-2 hidden lg:block bg-white px-3 py-1 rounded-full shadow-sm border border-slate-100">
                      è¨­è¨ˆè€…ï¼šé„­å¿µæ…ˆè€å¸«
                    </div>
                    <div className="text-xs 2xl:text-sm font-bold text-orange-500 bg-orange-50 px-4 py-1.5 rounded-full border-2 border-orange-100 shadow-inner flex items-center gap-1">
                      <AlertCircle className="w-3 h-3" />
                      é²åˆ°æ¨™æº–: {lateThreshold}
                    </div>
                    
                    {/* æª¢è¦–æ¨¡å¼åˆ‡æ› */}
                    <div className="flex items-center bg-slate-100 p-1 rounded-xl border border-slate-200">
                       <button 
                         onClick={() => setViewMode('split')} 
                         className={`px-3 py-1.5 rounded-lg transition-all text-xs 2xl:text-sm font-bold ${viewMode === 'split' ? 'bg-white shadow text-blue-600' : 'text-slate-500 hover:text-slate-700'}`}
                       >
                         åˆ†å±é¡¯ç¤º
                       </button>
                       <button 
                         onClick={() => setViewMode('checkin')} 
                         className={`px-3 py-1.5 rounded-lg transition-all text-xs 2xl:text-sm font-bold ${viewMode === 'checkin' ? 'bg-white shadow text-blue-600' : 'text-slate-500 hover:text-slate-700'}`}
                       >
                         æ‰“å¡
                       </button>
                       <button 
                         onClick={() => setViewMode('notebook')} 
                         className={`px-3 py-1.5 rounded-lg transition-all text-xs 2xl:text-sm font-bold ${viewMode === 'notebook' ? 'bg-white shadow text-blue-600' : 'text-slate-500 hover:text-slate-700'}`}
                       >
                         è¯çµ¡ç°¿
                       </button>
                    </div>

                    <div className="w-px h-6 bg-slate-200 mx-1"></div>

                    <div className="flex items-center bg-slate-50 p-1.5 rounded-2xl border-2 border-slate-100 gap-1">
                      <button onClick={() => setShowSettings(!showSettings)} className="p-2 hover:bg-white hover:shadow-md hover:text-orange-500 rounded-xl text-slate-500 transition-all active:scale-95" title="è¨­å®š">
                        <Settings className="w-5 h-5 2xl:w-6 2xl:h-6" />
                      </button>

                      <button onClick={triggerImport} className="flex items-center gap-1 px-3 py-1.5 hover:bg-white hover:shadow-md hover:text-blue-500 text-slate-600 rounded-xl transition-all text-xs 2xl:text-sm font-bold active:scale-95" title="é‚„åŸç³»çµ±å‚™ä»½">
                        <Upload className="w-4 h-4" />
                        <span className="hidden xl:inline">åŒ¯å…¥</span>
                      </button>

                      <button onClick={handleBackupJSON} className="flex items-center gap-1 px-3 py-1.5 hover:bg-white hover:shadow-md hover:text-green-500 text-slate-600 rounded-xl transition-all text-xs 2xl:text-sm font-bold active:scale-95" title="ç³»çµ±è³‡æ–™å‚™ä»½">
                        <FileJson className="w-4 h-4" />
                        <span className="hidden xl:inline">åŒ¯å‡º</span>
                      </button>

                      <button onClick={handleExportCSV} className="flex items-center gap-1 px-3 py-1.5 hover:bg-white hover:shadow-md hover:text-purple-500 text-slate-600 rounded-xl transition-all text-xs 2xl:text-sm font-bold active:scale-95" title="ä¸‹è¼‰ CSV å ±è¡¨">
                        <FileSpreadsheet className="w-4 h-4" />
                        <span className="hidden xl:inline">ä¸‹è¼‰CSV</span>
                      </button>

                      <div className="w-px h-6 bg-slate-200 mx-1"></div>

                      <button onClick={resetSystem} className="p-2 hover:bg-red-50 hover:text-red-500 hover:shadow-md rounded-xl text-slate-400 transition-all active:scale-95" title="é‡ç½®æ‰“å¡ç‹€æ…‹">
                        <RotateCcw className="w-5 h-5 2xl:w-6 2xl:h-6" />
                      </button>
                    </div>
                 </div>
              </div>

              {/* è¨­å®šé¢æ¿ */}
              {showSettings && (
                <div className="absolute top-20 right-6 z-50 bg-white border-4 border-orange-100 p-6 rounded-3xl shadow-[0_10px_40px_-10px_rgba(0,0,0,0.1)] w-96 animate-fade-in-down max-h-[80vh] overflow-y-auto">
                  <div className="flex justify-between items-center mb-6 border-b-2 border-slate-50 pb-3">
                     <h3 className="font-black text-slate-700 flex items-center gap-2 text-lg">
                       <div className="bg-blue-100 p-1.5 rounded-lg">
                         <Settings className="w-5 h-5 text-blue-500" />
                       </div>
                       ç³»çµ±è¨­å®š
                     </h3>
                     <button onClick={() => setShowSettings(false)} className="w-8 h-8 flex items-center justify-center rounded-full bg-slate-100 text-slate-400 hover:bg-red-100 hover:text-red-500 transition-colors">âœ•</button>
                  </div>
                  
                  <div className="space-y-5">
                    <div>
                      <label className="block text-sm font-bold text-slate-600 mb-2">â° é²åˆ°æ™‚é–“</label>
                      <input type="time" value={lateThreshold} onChange={(e) => setLateThreshold(e.target.value)}
                        className="block w-full px-4 py-2.5 bg-slate-50 border-2 border-slate-200 rounded-xl focus:ring-4 focus:ring-orange-100 focus:border-orange-300 transition-all outline-none font-bold text-slate-700" />
                    </div>

                    {/* å­—é«”é¸æ“‡ */}
                    <div>
                       <label className="block text-sm font-bold text-slate-600 mb-2">ğŸ”¤ é¡¯ç¤ºå­—é«”</label>
                       <div className="flex gap-2">
                         <button 
                           onClick={() => setFontType('sans')} 
                           className={`flex-1 py-2 rounded-xl text-sm font-bold border-2 transition-all ${fontType === 'sans' ? 'bg-blue-500 text-white border-blue-500' : 'bg-white text-slate-600 border-slate-200'}`}
                         >
                           é»‘é«” (é è¨­)
                         </button>
                         <button 
                           onClick={() => setFontType('kai')} 
                           className={`flex-1 py-2 rounded-xl text-sm font-bold border-2 transition-all ${fontType === 'kai' ? 'bg-blue-500 text-white border-blue-500' : 'bg-white text-slate-600 border-slate-200'}`}
                           style={{ fontFamily: "'æ¨™æ¥·é«”', serif" }}
                         >
                           æ¨™æ¥·é«”
                         </button>
                         <button 
                           onClick={() => setFontType('zhuyin')} 
                           className={`flex-1 py-2 rounded-xl text-sm font-bold border-2 transition-all ${fontType === 'zhuyin' ? 'bg-blue-500 text-white border-blue-500' : 'bg-white text-slate-600 border-slate-200'}`}
                         >
                           æ³¨éŸ³å­—å‹
                         </button>
                       </div>
                       <p className="text-xs text-slate-400 mt-2">
                         * æ³¨éŸ³å­—å‹éœ€é›»è…¦å·²å®‰è£ã€Œç‹æ¼¢å®—ã€æˆ–ã€Œæ–‡é¼ã€ç­‰æ³¨éŸ³å­—é«”æ‰æœƒé¡¯ç¤ºï¼Œå¦å‰‡é¡¯ç¤ºæ¨™æ¥·é«”ã€‚
                       </p>
                    </div>
                    
                    <div className="p-4 bg-orange-50 rounded-2xl border-2 border-orange-100">
                        <h4 className="text-sm font-bold text-orange-700 mb-3 flex items-center gap-1">
                            <Users className="w-4 h-4" /> å­¸ç”Ÿåå–®è¨­å®š
                        </h4>
                        
                        <div className="space-y-3 opacity-100 hover:opacity-100 transition-opacity">
                            <div>
                                <label className="block text-xs font-bold text-slate-600 mb-1">æ–¹å¼ Aï¼šåƒ…ä½¿ç”¨æ•¸å­—åº§è™Ÿ (å„ªå…ˆä½¿ç”¨)</label>
                                <div className="flex items-center gap-2">
                                    <span className="text-xs text-slate-500">ç¸½äººæ•¸:</span>
                                    <input type="number" min="1" max="60" value={studentCount} onChange={(e) => handleSettingChange(Number(e.target.value), emptyNumbersInput, customNamesInput)}
                                        className="w-20 px-2 py-1 bg-white border border-slate-300 rounded-lg text-center" disabled={customNamesInput.length > 0} />
                                </div>
                            </div>
                            <div>
                                <label className="block text-xs font-bold text-slate-600 mb-1">ç©ºè™Ÿ (é€—è™Ÿåˆ†éš”)</label>
                                <input 
                                    type="text" 
                                    value={emptyNumbersInput} 
                                    onChange={(e) => handleSettingChange(studentCount, e.target.value, customNamesInput)}
                                    placeholder="ä¾‹å¦‚: 2, 5"
                                    className="block w-full px-2 py-1 bg-white border border-slate-300 rounded-lg text-sm" disabled={customNamesInput.length > 0} />
                            </div>
                        </div>

                        <div className="border-t border-orange-200 my-3"></div>

                        <div className="mb-2">
                            <label className="block text-xs font-bold text-slate-600 mb-1">æ–¹å¼ Bï¼šåŒ¯å…¥å­¸ç”Ÿåå–®</label>
                            <textarea 
                                value={customNamesInput}
                                onChange={(e) => handleSettingChange(studentCount, emptyNumbersInput, e.target.value)}
                                placeholder="è«‹è²¼ä¸Šå­¸ç”Ÿå§“åï¼Œä¸€è¡Œä¸€å€‹ï¼Œæˆ–æ˜¯ç”¨é€—è™Ÿåˆ†éš”ã€‚&#10;ä¾‹å¦‚ï¼š&#10;ç‹å°æ˜&#10;æå¤§åŒ&#10;å¼µç¾éº—"
                                className="block w-full h-24 px-3 py-2 bg-white border-2 border-orange-200 rounded-xl focus:ring-2 focus:ring-orange-300 transition-all outline-none text-sm resize-none"
                            />
                            <p className="text-xs text-orange-600 mt-1">* è‹¥æ­¤æ¬„ä½æœ‰å…§å®¹ï¼Œå°‡è‡ªå‹•è¦†è“‹æ•¸å­—è¨­å®šã€‚</p>
                        </div>
                    </div>
                  </div>
                </div>
              )}

              {/* ä¸»ç•«é¢ */}
              <div ref={splitContainerRef} className="flex-1 flex flex-col lg:flex-row overflow-hidden p-3 gap-3">
                
                {/* å·¦å´ï¼šæ‰“å¡å€ */}
                <div 
                  className={`flex flex-col bg-white rounded-[2.5rem] shadow-xl border-4 border-white overflow-hidden relative transition-all duration-300 ease-in-out ${viewMode === 'notebook' ? 'hidden' : ''}`}
                  style={viewMode === 'split' && typeof window !== 'undefined' && window.innerWidth >= 1024 ? { width: `calc(${splitRatio}% - 0.75rem)`, flex: 'none' } : { flex: 1 }}
                >
                  <div className="absolute inset-0 bg-grid-slate-50 [mask-image:linear-gradient(0deg,white,rgba(255,255,255,0.6))] pointer-events-none"></div>
                  
                  {/* å¤§æ™‚é˜å€ - å‹•æ…‹åˆ‡æ›é¢¨æ ¼ */}
                  <div className="p-2 flex flex-col items-center shrink-0 z-10 cursor-pointer group/clock" onClick={toggleClockStyle} title="é»æ“Šåˆ‡æ›æ™‚é˜é¢¨æ ¼">
                    <div className={`${currentClockStyle.container} font-mono text-5xl xl:text-6xl 2xl:text-7xl px-8 py-3 rounded-2xl border-4 relative overflow-hidden tracking-widest flex items-center justify-center min-w-[320px] transition-all duration-300 group-hover/clock:scale-105 group-hover/clock:shadow-lg`}>
                        <div className={`absolute inset-0 pointer-events-none ${currentClockStyle.overlay}`}></div>
                        <span className={`relative z-10 font-bold flex items-center gap-3 ${currentClockStyle.text}`}>
                          <Clock className={`w-8 h-8 2xl:w-10 2xl:h-10 ${currentClockStyle.icon}`} />
                          {formatTime(currentTime)}
                        </span>
                    </div>
                    <div className={`flex items-center gap-1 text-xs mt-2 font-bold px-3 py-1 rounded-full opacity-100 transition-all ${currentClockStyle.labelColor}`}>
                        <Palette className="w-3 h-3" />
                        é»æ“Šåˆ‡æ›é¢¨æ ¼
                    </div>
                  </div>

                  {/* çµ±è¨ˆåˆ— (å†ç¸®å°ç‰ˆ + æ©«å¼æ’åˆ—) */}
                  <div className="px-4 py-1 grid grid-cols-4 gap-2 shrink-0">
                     <StatBadgeMini label="æ‡‰åˆ°" value={stats.total} bg="bg-blue-50" text="text-blue-600" border="border-blue-200" />
                     <StatBadgeMini label="å·²åˆ°" value={stats.present} bg="bg-green-50" text="text-green-600" border="border-green-200" />
                     {/* é²åˆ° -> ç´…è‰² */}
                     <StatBadgeMini label="é²åˆ°" value={stats.lateArrived} bg="bg-red-50" text="text-red-600" border="border-red-200" />
                     {/* æœªåˆ° -> é»ƒè‰² */}
                     <StatBadgeMini label="æœªåˆ°" value={stats.idle + stats.lateAbsent} bg="bg-yellow-50" text="text-yellow-600" border="border-yellow-200" alert={stats.lateAbsent > 0} />
                  </div>

                  {/* å­¸ç”ŸæŒ‰éˆ•å€ */}
                  <div className="flex-1 p-2 overflow-hidden z-10">
                     <div 
                        className={`grid ${getGridColsClass()} gap-2 h-full`}
                        style={{ 
                          gridAutoRows: 'minmax(0, 1fr)',
                          fontFamily: currentFontFamily 
                        }}
                     >
                      {students.map((student) => (
                        <StudentButton 
                          key={student.id} 
                          student={student} 
                          fontFamily={currentFontFamily}
                          onClick={() => handleCheckIn(student.id)} 
                        />
                      ))}
                    </div>
                  </div>
                </div>

                {/* æ‹–æ›³èª¿æ•´æ¢ (åƒ…åœ¨åˆ†å±æ¨¡å¼ä¸”æ¡Œé¢ç‰ˆé¡¯ç¤º) */}
                {viewMode === 'split' && (
                  <div 
                    className="hidden lg:flex w-4 cursor-col-resize items-center justify-center hover:bg-slate-200 rounded-full transition-colors z-30 -ml-2 -mr-2"
                    onMouseDown={handleDragStart}
                  >
                    <div className="w-1 h-8 bg-slate-300 rounded-full"></div>
                  </div>
                )}

                {/* å³å´ï¼šé»‘æ¿è¯çµ¡ç°¿å€ */}
                <div 
                  className={`flex flex-col p-6 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] relative justify-center items-center rounded-[2.5rem] border-4 border-amber-100/50 transition-all duration-300 ease-in-out ${viewMode === 'checkin' ? 'hidden' : ''}`}
                  style={viewMode === 'split' && typeof window !== 'undefined' && window.innerWidth >= 1024 ? { width: `calc(${100 - splitRatio}% - 0.75rem)`, flex: 'none' } : { flex: 1 }}
                >
                  
                  {/* é»‘æ¿å¤–æ¡†å®¹å™¨ */}
                  <div className={`w-full h-full bg-[#2d4035] border-[16px] border-[#a0522d] rounded-[3rem] shadow-[0_20px_50px_-10px_rgba(0,0,0,0.3),inset_0_0_40px_rgba(0,0,0,0.5)] flex flex-col relative overflow-hidden ring-4 ring-[#8b4513]/30 group`}>
                    
                    <div className="absolute top-4 left-1/2 -translate-x-1/2 w-32 h-1 bg-white/10 rounded-full"></div>
                    
                    {/* é»‘æ¿é ‚éƒ¨è³‡è¨Šåˆ— */}
                    <div className="flex flex-col xl:flex-row justify-between items-start xl:items-end p-6 pb-2 text-white/90 z-10 shrink-0 border-b-2 border-white/10 border-dashed mx-4">
                      <div className="flex flex-wrap items-baseline gap-4 w-full">
                        <h2 className="text-3xl 2xl:text-4xl font-black tracking-widest font-serif text-[#f0f0f0] drop-shadow-md transform -rotate-1 origin-bottom-left flex items-center gap-2">
                          <Star className="w-8 h-8 text-yellow-300 fill-yellow-300 animate-pulse" />
                          ä»Šæ—¥è¯çµ¡ç°¿
                        </h2>
                        
                        {/* æ—¥æœŸå°èˆª */}
                        <div className="flex items-center gap-3">
                           <button onClick={() => changeDate(-1)} className="p-1 rounded-full bg-white/10 hover:bg-white/20 text-white transition-all hover:scale-110 active:scale-95" title="å‰ä¸€å¤©">
                             <ChevronLeft className="w-5 h-5" />
                           </button>
                           
                           <p className={`text-xl 2xl:text-2xl font-serif font-bold ${isToday(notebookDate) ? 'text-yellow-200' : 'text-white/80'}`}>
                             {formatNotebookDate(notebookDate)}
                           </p>
                           
                           <button onClick={() => changeDate(1)} className="p-1 rounded-full bg-white/10 hover:bg-white/20 text-white transition-all hover:scale-110 active:scale-95" title="å¾Œä¸€å¤©">
                             <ChevronRight className="w-5 h-5" />
                           </button>
                        </div>
                      </div>

                      <div className="flex items-center gap-2 mt-4 xl:mt-0 self-end xl:self-auto ml-auto">
                         {/* å­—é«”å¤§å°èª¿æ•´ */}
                         <div className="flex items-center bg-white/10 rounded-lg mr-2">
                            <button onClick={() => adjustFontSize(-2)} className="p-1.5 hover:bg-white/20 text-white transition-colors rounded-l-lg" title="ç¸®å°å­—é«”">
                              <Minus className="w-4 h-4" />
                            </button>
                            <span className="text-xs font-mono font-bold text-white/80 px-1 w-8 text-center">{notebookFontSize}</span>
                            <button onClick={() => adjustFontSize(2)} className="p-1.5 hover:bg-white/20 text-white transition-colors rounded-r-lg" title="æ”¾å¤§å­—é«”">
                              <Plus className="w-4 h-4" />
                            </button>
                         </div>

                         <button 
                           onClick={() => setWritingMode(prev => prev === 'horizontal' ? 'vertical' : 'horizontal')}
                           className="flex items-center gap-1 px-3 py-1.5 bg-[#ffffff20] hover:bg-[#ffffff30] rounded-xl text-sm transition-all border border-white/20 text-white font-bold active:scale-95"
                           title={writingMode === 'horizontal' ? "åˆ‡æ›ç‚ºç›´å¼æ›¸å¯«" : "åˆ‡æ›ç‚ºæ©«å¼æ›¸å¯«"}
                         >
                           {writingMode === 'horizontal' ? (
                             <><AlignVerticalJustifyStart className="w-4 h-4" /> ç›´å¼</>
                           ) : (
                             <><AlignHorizontalJustifyStart className="w-4 h-4" /> æ©«å¼</>
                           )}
                         </button>

                         <button 
                           onClick={() => setIsEditingNote(!isEditingNote)}
                           className={`flex items-center gap-2 px-4 py-1.5 rounded-xl text-sm transition-all border font-bold shadow-lg active:scale-95 ${isEditingNote ? 'bg-green-500 border-green-400 text-white hover:bg-green-400' : 'bg-yellow-400 border-yellow-300 text-yellow-900 hover:bg-yellow-300'}`}
                         >
                           {isEditingNote ? <Check className="w-4 h-4" /> : <Edit3 className="w-4 h-4" />}
                           {isEditingNote ? "å®Œæˆ" : "ç·¨è¼¯"}
                         </button>
                      </div>
                    </div>

                    {/* ç·¨è¼¯èˆ‡é¡¯ç¤ºå€ */}
                    <div className="relative flex-1 p-6 z-10 overflow-hidden">
                       {isEditingNote ? (
                         <textarea
                          value={currentNoteContent}
                          onChange={(e) => updateCurrentNote(e.target.value)}
                          className={`w-full h-full bg-black/20 text-white leading-relaxed font-serif outline-none resize-none placeholder-white/20 tracking-wide font-medium drop-shadow-md rounded-2xl p-6 border-4 border-dashed border-white/20 ${writingMode === 'vertical' ? '[writing-mode:vertical-rl]' : ''}`}
                          style={{ 
                            fontFamily: currentFontFamily,
                            fontSize: `${notebookFontSize}px`
                          }}
                          placeholder={`è«‹è¼¸å…¥ ${formatNotebookDate(notebookDate)} çš„äº‹é …...`}
                          autoFocus
                        />
                       ) : (
                         <>
                           {writingMode === 'horizontal' ? (
                             <div 
                               className="w-full h-full grid grid-flow-col grid-rows-5 gap-x-12 gap-y-3 content-start px-2"
                               style={{ 
                                 fontFamily: currentFontFamily,
                                 fontSize: `${notebookFontSize}px`
                               }}
                             >
                                {validNoteLines.map((line, index) => (
                                  <div key={index} className={`flex items-start gap-3 text-white font-medium drop-shadow-md break-words min-w-0`}>
                                     <span className={`text-yellow-400 mt-0.5 select-none opacity-90 font-black font-mono bg-white/10 ${notebookFontSize > 30 ? 'w-12 h-12 text-2xl' : 'w-8 h-8 text-xl'} rounded-full flex items-center justify-center shadow-sm`}>{index + 1}</span>
                                     <span>{line}</span>
                                  </div>
                                ))}
                             </div>
                           ) : (
                             <div 
                               className="w-full h-full flex flex-col flex-wrap content-start gap-8 [writing-mode:vertical-rl] px-2"
                               style={{ 
                                 fontFamily: currentFontFamily,
                                 fontSize: `${notebookFontSize}px`
                               }}
                             >
                                {validNoteLines.map((line, index) => (
                                  <div key={index} className={`flex items-start gap-3 text-white font-medium drop-shadow-md my-2`}>
                                     <span className={`text-yellow-400 mt-1 select-none opacity-90 font-black font-mono bg-white/10 ${notebookNumberSize} rounded-full flex items-center justify-center shadow-sm [writing-mode:horizontal-tb]`}>{index + 1}</span>
                                     <span className="leading-normal pt-2">{line}</span>
                                  </div>
                                ))}
                             </div>
                           )}
                         </>
                       )}
                    </div>
                    
                    {/* é»‘æ¿åº•éƒ¨ç²‰ç­†æ§½å€ (è®Šå°) */}
                    <div className="h-8 bg-[#3e2714] border-t-8 border-[#2a1a0e] relative flex items-center px-8 shadow-inner z-20 shrink-0">
                       <div className="flex gap-4 absolute left-10 -top-1">
                         <div className="w-12 h-2 bg-white rounded-sm shadow-md transform rotate-2 opacity-90"></div>
                         <div className="w-8 h-2 bg-pink-300 rounded-sm shadow-md transform -rotate-1 opacity-90"></div>
                         <div className="w-6 h-2 bg-blue-300 rounded-sm shadow-md transform rotate-3 opacity-90"></div>
                       </div>
                    </div>

                  </div>
                </div>

              </div>
            </div>
          );
        };

        // -------------------------------------
        // è¼”åŠ©å…ƒä»¶
        // -------------------------------------
        const StatBadgeMini = ({ label, value, bg, text, border, alert }) => (
          // ä¿®æ”¹ç‚ºæ©«å¼æ’åˆ— (flex-row)ï¼Œä¸¦ç¸®å°å­—é«”
          <div className={`flex flex-row items-center justify-center gap-2 p-1.5 rounded-xl ${bg} ${text} shadow-sm border ${border} ${alert ? 'animate-pulse ring-4 ring-red-100' : ''}`}>
            <span className="text-xs font-bold opacity-80">{label}:</span>
            <span className="text-lg 2xl:text-xl font-black drop-shadow-sm">{value}</span>
          </div>
        );

        const StudentButton = ({ student, onClick, fontFamily }) => {
          let baseClasses = "relative w-full h-full rounded-2xl shadow-sm flex flex-col items-center justify-center transition-all duration-100 transform cursor-pointer select-none border-b-[6px] p-1 active:border-b-0 active:translate-y-[6px]";
          let statusClasses = "";
          let content = null;

          switch (student.status) {
            case 'empty':
              baseClasses = "relative w-full h-full rounded-2xl flex flex-col items-center justify-center border-4 border-dashed border-slate-200 bg-slate-50/50 opacity-50 cursor-default p-1";
              content = React.createElement("span", { className: "text-sm font-bold text-slate-300", style: { fontFamily } }, student.name);
              break;

            case 'idle':
              statusClasses = "bg-white hover:bg-slate-50 border-slate-200 text-slate-300 hover:text-slate-400";
              content = React.createElement("span", { className: "text-2xl md:text-3xl 2xl:text-4xl font-black", style: { fontFamily } }, student.name);
              break;
            case 'present':
              statusClasses = "bg-emerald-100 hover:bg-emerald-200 border-emerald-300 text-emerald-600";
              content = React.createElement(React.Fragment, null,
                React.createElement("span", { className: "text-xl md:text-2xl 2xl:text-3xl font-black leading-none mb-1", style: { fontFamily } }, student.name),
                React.createElement("span", { className: "text-[10px] md:text-xs 2xl:text-sm font-black mt-0.5 bg-white/60 px-2 py-0.5 rounded-full leading-tight text-emerald-700 shadow-sm" }, student.arrivalTime)
              );
              break;
            case 'late_absent':
              statusClasses = "bg-rose-100 hover:bg-rose-200 border-rose-300 text-rose-500 ring-2 ring-rose-200";
              content = React.createElement(React.Fragment, null,
                React.createElement("span", { className: "text-xl md:text-2xl 2xl:text-3xl font-black leading-none mb-1", style: { fontFamily } }, student.name),
                React.createElement("span", { className: "text-[10px] 2xl:text-xs font-black mt-0.5 animate-bounce leading-tight bg-rose-200 px-2 py-0.5 rounded-full" }, "é²åˆ°")
              );
              break;
            case 'late_arrived':
              statusClasses = "bg-rose-100 hover:bg-rose-200 border-rose-300 text-rose-700";
              content = React.createElement(React.Fragment, null,
                React.createElement("span", { className: "text-xl md:text-2xl 2xl:text-3xl font-black leading-none mb-2", style: { fontFamily } }, student.name),
                React.createElement("div", { className: "flex items-center justify-center gap-1 w-full flex-row" },
                   React.createElement("span", { className: "text-[9px] md:text-[10px] 2xl:text-xs font-black bg-rose-600 text-white px-1.5 py-0.5 rounded-md leading-none shadow-sm" }, "é²åˆ°"),
                   React.createElement("span", { className: "text-[10px] md:text-xs 2xl:text-sm font-bold opacity-90 leading-none" }, student.arrivalTime)
                )
              );
              break;
            default: break;
          }

          return React.createElement("button", { className: `${baseClasses} ${statusClasses}`, onClick: onClick }, content);
        };

        // æ¸²æŸ“æ‡‰ç”¨ç¨‹å¼
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
